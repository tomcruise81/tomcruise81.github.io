(this["webpackJsonpcafl-player-react"]=this["webpackJsonpcafl-player-react"]||[]).push([[0],{38:function(e,t,n){var r=n(78).clean,a=/[.*+?^${}()|[\]\\]/g,o=/[a-z0-9_]/i,c=/\s+/;e.exports=function(e,t,n){var i,l;return l={insideWords:!1,findAllOccurrences:!1,requireMatchAll:!1},i=(i=n)||{},Object.keys(i).forEach((function(e){l[e]=!!i[e]})),n=l,e=r(e),(t=r(t)).trim().split(c).filter((function(e){return e.length>0})).reduce((function(t,r){var c,i,l=r.length,s=!n.insideWords&&o.test(r[0])?"\\b":"",u=new RegExp(s+r.replace(a,"\\$&"),"i");if(c=u.exec(e),n.requireMatchAll&&null===c)return e="",[];for(;c&&(i=c.index,t.push([i,i+l]),e=e.slice(0,i)+new Array(l+1).join(" ")+e.slice(i+l),n.findAllOccurrences);)c=u.exec(e);return t}),[]).sort((function(e,t){return e[0]-t[0]}))}},68:function(e,t,n){e.exports=n(80)},80:function(e,t,n){"use strict";n.r(t);var r=n(31),a=n(19),o=n(48),c=n(49),i=n(60),l=n(0),s=n.n(l),u=n(10),m=n.n(u),p=n(130),f=n(11),d=n(123),g=n(4),v=n(32);function b(e){return s.a.createElement(v.a,e,s.a.createElement("svg",{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 32 32",enableBackground:"new 0 0 32 32"},s.a.createElement("polyline",{fill:"none",strokeMiterlimit:"10",strokeWidth:"2.5",stroke:"currentColor",points:"1.5,15.5 1.5,1.5 16.5,1.5 16.5,30.5 30.5,30.5 30.5,15.5 "})))}function h(e){return s.a.createElement(v.a,e,s.a.createElement("svg",{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 32 32",enableBackground:"new 0 0 32 32"},s.a.createElement("polyline",{fill:"none",strokeMiterlimit:"10",strokeWidth:"2.5",stroke:"currentColor",points:"1.5,15.5 9.5,1.5 22.5,30.5 30.5,15.5"})))}function y(e){return s.a.createElement(v.a,e,s.a.createElement("svg",{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 32 32",enableBackground:"new 0 0 32 32"},s.a.createElement("polyline",{fill:"none",strokeMiterlimit:"10",strokeWidth:"2.5",stroke:"currentColor",points:"1.5,15.5 1.5,1.5 30.5,30.5 30.5,15.5 "})))}function E(e){return s.a.createElement(v.a,e,s.a.createElement("svg",{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 32 32",enableBackground:"new 0 0 32 32"},s.a.createElement("path",{fill:"none",strokeMiterlimit:"10",strokeWidth:"2.5",stroke:"currentColor",d:"M30.5,15.5c0,17-14,17.8-14,0c0-17.2-15-16-15,0 "})))}var O=n(51),w=n.n(O),x=n(126),j=n(124),k=n(125),S=n(136),C=Object(d.a)((function(e){return{paper:{display:"flex",border:"1px solid ".concat(e.palette.divider),flexWrap:"wrap"},divider:{alignSelf:"stretch",height:"auto",margin:e.spacing(1,.5)}}})),P=Object(g.a)((function(e){return{grouped:{margin:e.spacing(.5),border:"none",padding:e.spacing(0,1),"&:not(:first-child)":{borderRadius:e.shape.borderRadius},"&:first-child":{borderRadius:e.shape.borderRadius}}}}))(S.a);function q(e){var t=e.optionsChangeCallback,n=s.a.useState("sine"),r=Object(f.a)(n,2),a=r[0],o=r[1],c=s.a.useState(!0),i=Object(f.a)(c,2),l=i[0],u=i[1],m=C();return s.a.createElement("div",null,s.a.createElement(j.a,{elevation:0,className:m.paper},s.a.createElement(P,{size:"small",value:a,exclusive:!0,onChange:function(e,n){o(n),t({waveform:n,loop:l})},"aria-label":"waveform"},s.a.createElement(k.a,{value:"square","aria-label":"square waves"},s.a.createElement(b,null)),s.a.createElement(k.a,{value:"triangle","aria-label":"triangle waves"},s.a.createElement(h,null)),s.a.createElement(k.a,{value:"sawtooth","aria-label":"sawtooth waves"},s.a.createElement(y,null)),s.a.createElement(k.a,{value:"sine","aria-label":"sine waves"},s.a.createElement(E,null))),s.a.createElement(x.a,{orientation:"vertical",className:m.divider}),s.a.createElement(P,{size:"small","arial-label":"text formatting"},s.a.createElement(k.a,{value:"loop",selected:l,onClick:function(){u(!l),t({waveform:a,loop:!l})},"aria-label":"loop audio"},s.a.createElement(w.a,null)))))}var A=n(41),W=n.n(A),I=n(52),N=n(2),B=n(13),L=n(134),R=n(135),M=n(129),T=n(131),J=n(37),z=n.n(J),D=n(38),_=n.n(D),F=n(127),V=n(25),H=n(61);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){Object(B.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function G(e){var t=e.data,n=e.index,r=e.style;return s.a.cloneElement(t[n],{style:U({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},r)})}var K=s.a.forwardRef((function(e,t){var n=e.children,r=Object(N.a)(e,["children"]),a=Object(V.a)(),o=Object(F.a)(a.breakpoints.up("sm")),c=Array.isArray(n)?n.length:0,i=2.2*(o?36:48),l=s.a.useMemo((function(){return s.a.forwardRef((function(e,t){return s.a.createElement("div",Object.assign({ref:t},e,r))}))}),[]);return s.a.createElement("div",{ref:t},s.a.createElement(H.a,{style:{padding:0,height:Math.min(3,c)*i,maxHeight:"auto"},itemData:n,height:250,width:"100%",outerElementType:l,innerElementType:"ul",itemSize:i,overscanCount:5,itemCount:c},G))})),Q=Object(d.a)({listbox:{"& ul":{padding:0,margin:0}}});function X(e){var t=e.presetsChangeCallback,n=Q(),r=s.a.useState(!1),a=Object(f.a)(r,2),o=a[0],c=a[1],i=s.a.useState([]),l=Object(f.a)(i,2),u=l[0],m=l[1],d=s.a.useState(JSON.parse(localStorage.getItem("selectedPresets")||"[]")),g=Object(f.a)(d,2),v=g[0],b=g[1],h=o&&0===u.length;return s.a.useEffect((function(){localStorage.setItem("selectedPresets",JSON.stringify(v))}),[v]),s.a.useEffect((function(){var e=!0;if(h)return Object(I.a)(W.a.mark((function t(){var n,r,a,o;return W.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=localStorage.getItem("presets")){t.next=10;break}return t.next=4,fetch("".concat("/cafl-player-react/build","/cafl.json"));case 4:return r=t.sent,t.next=7,r.json();case 7:a=t.sent,localStorage.setItem("presets",JSON.stringify(a)),n=localStorage.getItem("presets");case 10:o=JSON.parse(n),e&&m(Object.keys(o.programs).map((function(e){var t=o.programs[e],n=e;return t.comments||(t.comments="None"),t.frequencies||(t.frequencies=[]),U({name:n},o.programs[e])})));case 12:case"end":return t.stop()}}),t)})))(),function(){e=!1}}),[h]),s.a.createElement(R.a,{id:"presets",multiple:!0,open:o,onOpen:function(){c(!0)},onClose:function(){c(!1)},value:v,onChange:function(e,n){b(n),t(n)},getOptionLabel:function(e){return e.name},filterSelectedOptions:!0,filterOptions:function(e,t){if(e.length>0){var n=t.inputValue.toLowerCase();return e.filter((function(e){return!!(e.name.toLowerCase().includes(n)||e.comments&&e.comments.toLowerCase().includes(n))}))}return[]},disableOpenOnFocus:!0,disableListWrap:!0,classes:n,ListboxComponent:K,freeSolo:!0,autoHighlight:!0,options:u,loading:h,renderInput:function(e){return s.a.createElement(L.a,Object.assign({},e,{label:"Presets",fullWidth:!0,variant:"outlined",InputProps:U({},e.InputProps,{endAdornment:s.a.createElement(s.a.Fragment,null,h?s.a.createElement(M.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment)})}))},renderOption:function(e,t){var n=t.inputValue,r={insideWords:!0,findAllOccurrences:!0},a=_()(e.name,n,r),o=z()(e.name,a),c=_()(e.comments,n,r),i=z()(e.comments,c),l=e.frequencies?e.frequencies.join(", "):void 0,u=_()(l,n,r),m=z()(l,u);return s.a.createElement(p.a,{container:!0,alignItems:"center"},s.a.createElement(p.a,{item:!0,xs:!0},o.map((function(e,t){return s.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})),s.a.createElement(T.a,{variant:"body2",color:"textSecondary"},e.comments&&"Comments: ",e.comments&&i.map((function(e,t){return s.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)}))),s.a.createElement(T.a,{variant:"body2",color:"textSecondary"},e.frequencies&&"Frequencies: ",e.frequencies&&m.map((function(e,t){return s.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})))))}})}var Y=n(132),Z=n(55),ee=n.n(Z),te=n(56),ne=n.n(te),re=Object(d.a)((function(e){return{fab:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)}}}));function ae(e){var t,n,r=e.presets,a=e.options,o=re(),c=s.a.useState(!1),i=Object(f.a)(c,2),l=i[0],u=i[1],m=s.a.useRef(null),p=s.a.useRef(null),d=1e3,g=[];function v(){if(m.current)try{m.current.onended=function(){},m.current.stop(0)}catch(e){}m.current=void 0,t=void 0}function b(e,t){g.push(setTimeout((function(){e}),t*d))}function h(){y(),v(),p.current=p.current||new(window.AudioContext||window.webkitAudioContext),t=p.current.createAnalyser(),m.current=p.current.createOscillator(),m.current.connect(t),t.connect(p.current.destination),t.fftSize=1024,m.current.type=a.waveform;for(var e=p.current.currentTime,o=0,c=[],i=0;i<r.length;i++){var l=r[i];l.frequencies&&(c=c.concat(l.frequencies))}var s=!0,u=!1,f=void 0;try{for(var d,g=c[Symbol.iterator]();!(s=(d=g.next()).done);s=!0){var E=d.value;m.current.frequency.setValueAtTime(E,e),b(E,o),e+=180,o+=180}}catch(O){u=!0,f=O}finally{try{s||null==g.return||g.return()}finally{if(u)throw f}}n=t.frequencyBinCount,new Uint8Array(n),m.current.onended=function(){console.log("onEnded event signled"),a.loop?setTimeout((function(){console.log("Repeating"),h()}),0):y()},1e3*o,m.current.start(),m.current.stop(e)}function y(){for(v();g.length;)clearTimeout(g.pop());b(0,0),void 0}function E(){var e=!l&&r.length>0;e?((new Date).getTime(),y(),p.current&&(p.current.close(),p.current=void 0),h()):(y(),p.current&&(p.current.close(),p.current=void 0)),u(e)}return s.a.createElement("div",null,l?s.a.createElement(Y.a,{"aria-label":"Stop",className:o.fab,color:"secondary",onClick:E},s.a.createElement(ne.a,null)):s.a.createElement(Y.a,{"aria-label":"Play",className:o.fab,color:"primary",onClick:E},s.a.createElement(ee.a,null)))}var oe=n(133),ce=n(59),ie=n(57),le=n.n(ie),se=n(58),ue=n.n(se),me=Object(ce.a)({palette:{primary:le.a,secondary:ue.a}}),pe=function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(o.a)(this,Object(c.a)(t).call(this,e))).state={presets:JSON.parse(localStorage.getItem("selectedPresets")||"[]"),options:{waveform:"sine",loop:!0}},n}return Object(i.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:me.root},s.a.createElement(p.a,{container:!0,spacing:3},s.a.createElement(p.a,{item:!0,xs:12},s.a.createElement(X,{presetsChangeCallback:function(t){e.setState({presets:t||[]})}})),s.a.createElement(p.a,{item:!0,xs:12,sm:6},s.a.createElement(q,{optionsChangeCallback:function(t){e.setState({options:t})}})),s.a.createElement(p.a,{item:!0,xs:12},s.a.createElement(ae,{presets:this.state.presets,options:this.state.options}))))}}]),t}(s.a.Component);m.a.render(s.a.createElement(oe.a,{theme:me},s.a.createElement(pe,null)),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.ac2697ab.chunk.js.map