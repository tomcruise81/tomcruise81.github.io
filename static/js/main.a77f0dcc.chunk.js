(this["webpackJsonpcafl-player-react"]=this["webpackJsonpcafl-player-react"]||[]).push([[0],{38:function(e,t,n){var s=n(83).clean,r=/[.*+?^${}()|[\]\\]/g,i=/[a-z0-9_]/i,a=/\s+/;e.exports=function(e,t,n){var o,l;return l={insideWords:!1,findAllOccurrences:!1,requireMatchAll:!1},o=(o=n)||{},Object.keys(o).forEach((function(e){l[e]=!!o[e]})),n=l,e=s(e),(t=s(t)).trim().split(a).filter((function(e){return e.length>0})).reduce((function(t,s){var a,o,l=s.length,c=!n.insideWords&&i.test(s[0])?"\\b":"",h=new RegExp(c+s.replace(r,"\\$&"),"i");if(a=h.exec(e),n.requireMatchAll&&null===a)return e="",[];for(;a&&(o=a.index,t.push([o,o+l]),e=e.slice(0,o)+new Array(l+1).join(" ")+e.slice(o+l),n.findAllOccurrences);)a=h.exec(e);return t}),[]).sort((function(e,t){return e[0]-t[0]}))}},42:function(e,t,n){e.exports=n.p+"static/media/common-vertex.5e838e7b.shader"},50:function(e,t){var n=window.Util||{};n.loadTrackSrc=function(e,t,n,s){var r=new XMLHttpRequest;r.open("GET",t,!0),r.responseType="arraybuffer",r.onload=function(){e.decodeAudioData(r.response,(function(e){n(e)}),(function(e){console.error(e)}))},s&&(r.onprogress=function(e){var t=e.loaded/e.total;s(t)}),r.send()},n.setLogScale=function(e,t,n,s){this.b=Math.log(t/s)/(e-n),this.a=t/Math.exp(this.b*e)},n.lin2log=function(e){return this.a*Math.exp(this.b*e)},n.log2lin=function(e){return Math.log(e/this.a)/this.b},e.exports=n},51:function(module,exports){var o3djs=o3djs||{},goog=goog||{};goog.typedef=!0,o3djs.global=this,o3djs.BROWSER_ONLY=!0,o3djs.provided_=[],o3djs.provide=function(e){if(o3djs.getObjectByName(e)&&!o3djs.implicitNamespaces_[e])throw'Namespace "'+e+'" already declared.';for(var t=e;t=t.substring(0,t.lastIndexOf("."));)o3djs.implicitNamespaces_[t]=!0;o3djs.exportPath_(e),o3djs.provided_.push(e)},o3djs.implicitNamespaces_={},o3djs.exportPath_=function(e,t,n){var s,r=e.split("."),i=n||o3djs.global;r[0]in i||!i.execScript||i.execScript("var "+r[0]);for(;r.length&&(s=r.shift());)!r.length&&o3djs.isDef(t)?i[s]=t:i=i[s]?i[s]:i[s]={}},o3djs.getObjectByName=function(e,t){for(var n=e.split("."),s=t||o3djs.global,r=0;r<n.length;++r){var i=n[r];if(!s[i])return null;s=s[i]}return s},o3djs.require=function(e){document.getElementsByTagName("script").length;if(console.log("rule",e),!o3djs.getObjectByName(e)){var t=o3djs.getPathFromRule_(e);if(!t)throw new Error("o3djs.require could not find: "+e);o3djs.included_[t]=!0,o3djs.writeScripts_()}},o3djs.basePath="",o3djs.included_={},o3djs.dependencies_={visited:{},written:{}},o3djs.findBasePath_=function(){var e=o3djs.global.document;if("undefined"!=typeof e)if(o3djs.global.BASE_PATH)o3djs.basePath=o3djs.global.BASE_PATH;else{o3djs.global.BASE_PATH=null;for(var t,n=e.getElementsByTagName("script"),s=0;t=n[s];s++){var r=t.src,i=r.length;if("o3djs/base.js"==r.substr(i-13))return void(o3djs.basePath=r.substr(0,i-13))}}},o3djs.writeScriptTag_=function(e){var t=o3djs.global.document;"undefined"==typeof t||o3djs.dependencies_.written[e]||(o3djs.dependencies_.written[e]=!0,t.write('<script type="text/javascript" src="'+e+'"><\/script>'))},o3djs.writeScripts_=function(){var e=[],t={},n=o3djs.dependencies_;function s(s){s in n.written||(s in n.visited?s in t||(t[s]=!0,e.push(s)):(n.visited[s]=!0,s in t||(t[s]=!0,e.push(s))))}for(var r in o3djs.included_)n.written[r]||s(r);for(var i=0;i<e.length;i++){if(!e[i])throw Error("Undefined script input");o3djs.writeScriptTag_(o3djs.basePath+e[i])}},o3djs.getPathFromRule_=function(e){return e.split(".").join("/")+".js"},o3djs.findBasePath_(),o3djs.isDef=function(e){return"undefined"!=typeof e},o3djs.exportSymbol=function(e,t,n){o3djs.exportPath_(e,t,n)},o3djs.v8Initializer_="",o3djs.v8InitializerArgs_=[],o3djs.valueToString_=function(e){switch(typeof e){case"undefined":return"undefined";case"string":var t=escape(e);return t===e?'"'+e+'"':'unescape("'+t+'")';case"object":if(null===e)return"null";if(e instanceof RegExp){var n="new RegExp("+o3djs.valueToString_(e.source)+', "';return e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),n+='")'}if(o3djs.base.isArray(e)){for(var s=e,r=(n="[",""),i=0;i<s.length;++i)n+=r+o3djs.valueToString_(s[i]),r=",";return n+="]\n"}var a=e;n="{\n",r="";for(var o in a)n+=r+'"'+o+'": '+o3djs.valueToString_(a[o]),r=",";return n+="}\n";default:return e.toString()}},o3djs.namespaceInitializer_=function(e,t,n){var s=t+" = {};\n";for(var r in e){var i=t+"."+r,a=e[r];if("object"!==typeof a||null===a||o3djs.base.isArray(a)||a instanceof RegExp){var o=o3djs.valueToString_(a);"function"==typeof a&&-1!=o.indexOf("o3djs.BROWSER_ONLY")&&(o="args_["+n.length+"]",n.push(a)),s+=i+" = "+o+";\n","function"===typeof a&&a.prototype&&(s+=o3djs.namespaceInitializer_(a.prototype,i+".prototype"))}else s+=o3djs.namespaceInitializer_(a,i)}return s},o3djs.provide("o3djs.base"),o3djs.base=o3djs.base||{},o3djs.base.o3d=null,o3djs.base.snapshotProvidedNamespaces=function(){o3djs.v8Initializer_="function(args_) {\n",o3djs.v8InitializerArgs_=[];for(var e=0;e<o3djs.provided_.length;++e){var t=o3djs.getObjectByName(o3djs.provided_[e]);o3djs.v8Initializer_+=o3djs.namespaceInitializer_(t,o3djs.provided_[e],o3djs.v8InitializerArgs_)}o3djs.v8Initializer_+="}\n"},o3djs.base.initV8=function(clientObject){var v8Init=function v8Init(initializer,args){var o3djsBrowser=o3djs;o3djs={},o3djs.browser=o3djsBrowser,o3djs.global=function(){return this}(),o3djs.require=function(e){},o3djs.provide=function(e){},eval("("+initializer+")")(args)};clientObject.eval(v8Init.toString())(o3djs.v8Initializer_,o3djs.v8InitializerArgs_)},o3djs.base.init=function(e){try{o3djs.base.o3d=function e(t){var n={},s=!1;for(var r in t){var i=t[r];"object"!=typeof i&&"function"!=typeof i||(i=e(i)),"undefined"!=typeof i&&(n[r]=i,s=!0)}return s?n:void 0}(e.o3d)}catch(t){o3djs.base.o3d=e.o3d}o3djs.base.o3d=o3djs.base.o3d||e.o3d},o3djs.base.isArray=function(e){return"object"===typeof e&&null!==e&&"length"in e&&"splice"in e},o3djs.base.ready=function(){return null!=o3djs.base.o3d},o3djs.base.maybeDeobfuscateFunctionName_=function(e){return e},o3djs.base.inherit=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n},o3djs.base.parseErrorStack=function(e){var t,n,s=[];if(!e||!e.stack)return s;for(var r=e.stack.split("\n"),i=0;i<r.length-1;i++){var a=r[i];t=(t=a.match(/^([a-zA-Z0-9_$]*)/)[1])?o3djs.base.maybeDeobfuscateFunctionName_(t):"anonymous";var o=a.match(/(.*:[0-9]+)$/);(n=o&&o[1])||(n="(unknown)"),s[s.length]=t+" : "+n}for(var l=/^anonymous :/;s.length&&l.exec(s[s.length-1]);)s.length=s.length-1;return s},o3djs.base.getFunctionName=function(e){var t=e.toString().match(/function(\s*)(\w*)/);return t&&t.length>=2&&t[2]?o3djs.base.maybeDeobfuscateFunctionName_(t[2]):"anonymous"},o3djs.base.formatErrorStack=function(e){for(var t="",n=0;n<e.length;n++)t+="> "+e[n]+"\n";return t},o3djs.base.getStackTrace=function(stripCount){var result="",testExcp;if("undefined"!=typeof arguments.caller){for(var a=arguments.caller;null!=a;a=a.caller)if(result+="> "+o3djs.base.getFunctionName(a.callee)+"\n",a.caller==a){result+="*";break}}else try{eval("var var;")}catch(testExcp){var stack=o3djs.base.parseErrorStack(testExcp);result+=o3djs.base.formatErrorStack(stack.slice(3+stripCount,stack.length))}return result},o3djs.base.setErrorHandler=function(e){e.setErrorCallback((function(t){e.clearErrorCallback(),alert("ERROR: "+t+"\n"+o3djs.base.getStackTrace(1))}))},o3djs.base.IsMSIE=function(){var e=navigator.userAgent.toLowerCase();return/msie/.test(e)&&!/opera/.test(e)},o3djs.base.IsChrome10=function(){return navigator.userAgent.indexOf("Chrome/1.0")>=0},module.exports=o3djs},52:function(e,t,n){e.exports=n.p+"static/media/sonogram-fragment.ff3e2717.shader"},73:function(e,t,n){e.exports=n(95)},85:function(e,t,n){"use strict";var s=n(41);window.isMobile=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),window.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,window.isAndroid=/Android/.test(navigator.userAgent)&&!window.MSStream,window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)};var r=n(86);s((function(){var e=function(){for(var e=function(){for(var e=window.location.search.slice(1).split("&"),t=0;t<e.length;++t){var n=e[t].split("=");e[t]={},e[t][n[0]]=n[1]}return e}(),t="en",n=0;n<e.length;n++)void 0!=e[n].ln&&(t=e[n].ln);var r="https://gweb-musiclab-site.appspot.com/static/locales/"+t+"/locale-music-lab.json";s.ajax({url:r,dataType:"json",async:!0,success:function(e){s.each(e,(function(e,t){var n=s("[data-name='"+e+"']");n.length>0&&(console.log("value.message",t.message),n.attr("data-name",t.message))}))},error:function(e){console.warn(e)}})},t=function(){e(),window.parent.postMessage("ready","*");var t=r;t.attached(),s(".music-box__tool-tip").hide(0),s("#loadingSound").hide(0),s(".music-box__buttons__button").click((function(e){t.startRender();t.isPlaying();t.stop(),t.drawingMode=!1,s(this).hasClass("selected")?s(".music-box__buttons__button").removeClass("selected"):(s(".music-box__buttons__button").removeClass("selected"),s(this).addClass("selected"),void 0!==s(this).attr("data-mic")?window.isIOS?(window.parent.postMessage("error2","*"),s(this).removeClass("selected")):(s("#record").fadeIn().delay(2e3).fadeOut(),t.live()):void 0!==s(this).attr("data-draw")?(t.drawingMode=!0,s("#drawAnywhere").fadeIn().delay(2e3).fadeOut()):void 0!==s(this).attr("data-src")&&(t.loopChanged(!0),s("#loadingMessage").text(s(this).attr("data-name")),t.play(s(this).attr("data-src"))))}));var n=function(){t.startRender();t.isPlaying();t.stop(),t.drawingMode=!1,s(".music-box__buttons__button").removeClass("selected")};window.addEventListener("blur",(function(){n()})),document.addEventListener("visibilitychange",(function(){n()}))},n=s("#iosButton");window.isIOS?(window.parent.postMessage("loaded","*"),n[0].addEventListener("touchend",(function(e){n.addClass("hide"),t()}),!1)):(n.addClass("hide"),t(),console.log(2))}))},86:function(e,t,n){"use strict";var s=n(50),r=n(87),i=n(88),a=n(41),o={cxRot:90,drawingMode:!1,prevX:0,handleTrack:function(e){switch(e.type){case"mousedown":case"touchstart":if(o.prevX=Number(e.pageX)||Number(e.originalEvent.touches[0].pageX),a(e.currentTarget).on("mousemove",o.handleTrack),a(e.currentTarget).on("touchmove",o.handleTrack),0==o.drawingMode)return!1;var t=o.yToFreq(Number(e.pageY)||Number(e.originalEvent.touches[0].pageY));return o.isPlaying()?o.player.setBandpassFrequency(t):o.player.playTone(t),!1;case"mousemove":case"touchmove":var n=(Number(e.pageX)||Number(e.originalEvent.touches[0].pageX))-o.prevX;if(o.prevX=Number(e.pageX)||Number(e.originalEvent.touches[0].pageX),o.drawingMode){var s=Number(e.pageY)||Number(e.originalEvent.touches[0].pageY);t=o.yToFreq(s);o.isPlaying()?o.player.setBandpassFrequency(t):o.player.playTone(t)}else o.isPlaying()&&(o.cxRot+=.2*n,o.cxRot<0?o.cxRot=0:o.cxRot>90&&(o.cxRot=90));return!1;case"mouseup":case"touchend":return a(e.currentTarget).off("mousemove",o.handleTrack),a(e.currentTarget).off("touchmove",o.handleTrack),0==o.drawingMode?!1:(o.isPlaying()?o.player.setBandpassFrequency(null):o.player.stopTone(),!1)}},attached:function(){console.log("spectrogram-3d attached"),s.setLogScale(20,20,2e4,2e4),o.onResize_(),o.init_(),window.addEventListener("resize",o.onResize_.bind(o))},stop:function(){o.player.stop()},isPlaying:function(){return!!this.player.source},stopRender:function(){o.isRendering=!1},startRender:function(){o.isRendering||(o.isRendering=!0,o.draw_())},loopChanged:function(e){o.player.setLoop(e)},play:function(e){o.src=e,o.player.playSrc(e)},live:function(){o.player.live()},userAudio:function(e){o.player.playUserAudio(e)},init_:function(){var e=new r,t=e.getAnalyserNode(),n=new i(this.canvas);n.setAnalyserNode(t),n.initByteBuffer(),o.player=e,o.analyserView=n,a("#spectrogram").on("mousedown",this.handleTrack).on("touchstart",this.handleTrack).on("mouseup",this.handleTrack).on("touchend",this.handleTrack)},onResize_:function(){console.log("onResize_");var e=a("#spectrogram")[0];o.canvas=e,e.width=a(window).width(),e.height=a(window).height()},draw_:function(){o.isRendering?(o.analyserView.doFrequencyAnalysis(),requestAnimationFrame(o.draw_.bind(o))):console.log("stopped draw_")},drawLegend_:function(){var e=a("#legend")[0],t=e.getContext("2d"),n=e.width-10;t.fillStyle="#FFFFFF",t.font="14px Roboto",t.textAlign="right",t.textBaseline="middle",t.fillText("20,000 Hz -",n,e.height-o.freqToY(2e4)),t.fillText("2,000 Hz -",n,e.height-o.freqToY(2e3)),t.fillText("200 Hz -",n,e.height-o.freqToY(200)),t.fillText("20 Hz -",n,e.height-o.freqToY(20))},freqStart:20,freqEnd:2e4,padding:30,yToFreq:function(e){var t=o.padding,n=a("#spectrogram").height();if(n<2*t||e<t||e>n-t)return null;var r=1-(e-t)/(n-t),i=o.freqStart+(o.freqEnd-o.freqStart)*r;return s.lin2log(i)},freqToY:function(e){var t=s.log2lin(e),n=a("#spectrogram").height(),r=o.padding,i=(t-o.freqStart)/(o.freqEnd-o.freqStart);return o.padding+i*(n-2*r)},easeInOutCubic:function(e,t,n,s){return(e/=s/2)<1?n/2*e*e*e+t:n/2*((e-=2)*e*e+2)+t},easeInOutQuad:function(e,t,n,s){return(e/=s/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},easeInOutQuint:function(e,t,n,s){return(e/=s/2)<1?n/2*e*e*e*e*e+t:n/2*((e-=2)*e*e*e*e+2)+t},easeInOutExpo:function(e,t,n,s){return 0==e?t:e==s?t+n:(e/=s/2)<1?n/2*Math.pow(2,10*(e-1))+t:n/2*(2-Math.pow(2,-10*--e))+t}};e.exports=o},87:function(e,t,n){var s=n(50),r=n(41);function i(){window.AudioContext=window.AudioContext||window.webkitAudioContext;var e=new AudioContext,t=e.createAnalyser();t.fftSize=window.isMobile?1024:2048,t.smoothingTimeConstant=0;var n=e.createGain(),s=e.createBiquadFilter();s.Q.value=10,s.type="bandpass";var r=e.createGain();r.gain.value=1,n.connect(t),t.connect(r),r.connect(e.destination),this.context=e,this.mix=n,this.filterGain=r,this.analyser=t,this.buffers={}}i.prototype.playSrc=function(e){return this.filterGain.gain.value=1,this.input?(this.input.disconnect(),void(this.input=null)):this.buffers[e]?(r("#loadingSound").fadeIn(100).delay(1e3).fadeOut(500),void this.playHelper_(e)):(r("#loadingSound").fadeIn(100),void s.loadTrackSrc(this.context,e,function(t){this.buffers[e]=t,this.playHelper_(e),r("#loadingSound").delay(500).fadeOut(500)}.bind(this)))},i.prototype.playUserAudio=function(e){if(this.filterGain.gain.value=1,this.input)return this.input.disconnect(),void(this.input=null);this.buffers.user=e.buffer,this.playHelper_("user")},i.prototype.playHelper_=function(e){var t=this.buffers[e];this.source=this.createSource_(t,!0),this.source.start(0),this.loop||(this.playTimer=setTimeout(function(){this.stop()}.bind(this),2e3*t.duration))},i.prototype.live=function(){if("suspended"===this.context.state&&this.context.resume(),window.isIOS)window.parent.postMessage("error2","*"),console.log("cant use mic on ios");else{if(this.input)return this.input.disconnect(),void(this.input=null);var e=this;navigator.mediaDevices.getUserMedia({audio:!0}).then((function(t){e.onStream_(t)})).catch((function(){e.onStreamError(this)})),this.filterGain.gain.value=0}},i.prototype.onStream_=function(e){var t=this.context.createMediaStreamSource(e);t.connect(this.mix),this.input=t,this.stream=e},i.prototype.onStreamError_=function(e){},i.prototype.setLoop=function(e){this.loop=e},i.prototype.createSource_=function(e,t){var n=this.context.createBufferSource();return n.buffer=e,n.loop=t,n.connect(this.mix),n},i.prototype.setMicrophoneInput=function(){},i.prototype.stop=function(){if(this.source&&(this.source.stop(0),this.source=null,clearTimeout(this.playTimer),this.playTimer=null),this.input)return this.input.disconnect(),void(this.input=null)},i.prototype.getAnalyserNode=function(){return this.analyser},i.prototype.setBandpassFrequency=function(e){null==e?(console.log("Removing bandpass filter"),this.mix.disconnect(),this.mix.connect(this.analyser)):(this.bandpass.frequency.value=e,this.mix.disconnect(),this.mix.connect(this.bandpass),this.filterGain.connect(this.analyser))},i.prototype.playTone=function(e){this.osc||(this.osc=this.context.createOscillator(),this.osc.connect(this.mix),this.osc.type="sine",this.osc.start(0)),this.osc.frequency.value=e,this.filterGain.gain.value=.2},i.prototype.stopTone=function(){this.osc.stop(0),this.osc=null},e.exports=i},88:function(e,t,n){var s=n(89),r=n(90),i=n(51);n(91);var a=0,o=0,l=0;var c=function(e){this.analysisType=2,this.sonogram3DWidth=256,this.sonogram3DHeight=256,this.sonogram3DGeometrySize=9.5,this.freqByteData=0,this.texture=0,this.TEXTURE_HEIGHT=256,this.yoffset=0,this.frequencyShader=0,this.waveformShader=0,this.sonogramShader=0,this.sonogram3DShader=0,this.backgroundColor=[.08,.08,.08,1],this.foregroundColor=[0,.7,0,1],this.canvas=e,this.initGL()};c.prototype.getAvailableContext=function(e,t){if(e.getContext)for(var n=0;n<t.length;++n)try{var s=e.getContext(t[n],{antialias:!0});if(null!==s)return s}catch(r){}return null},c.prototype.initGL=function(){a=new s,o=new s,l=new s;var e=this.sonogram3DWidth,t=this.sonogram3DHeight,c=this.sonogram3DGeometrySize,h=this.backgroundColor,u=this.canvas,d=this.getAvailableContext(u,["webgl","experimental-webgl"]);this.gl=d,this.has3DVisualizer=d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0,this.has3DVisualizer||2!=this.analysisType||(this.analysisType=0);var m=new r(u);this.cameraController=m,m.xRot=-180,m.yRot=270,m.zRot=90,m.xT=0,m.yT=-2,m.zT=-2,d.clearColor(h[0],h[1],h[2],h[3]),d.enable(d.DEPTH_TEST);var g=new Float32Array([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0]),f=new Float32Array([1,1,0,1,0,0,1,1,0,0,1,0]),p=g.byteLength;this.vboTexCoordOffset=p;var v=d.createBuffer();this.vbo=v,d.bindBuffer(d.ARRAY_BUFFER,v),d.bufferData(d.ARRAY_BUFFER,p+f.byteLength,d.STATIC_DRAW),d.bufferSubData(d.ARRAY_BUFFER,0,g),d.bufferSubData(d.ARRAY_BUFFER,p,f);var y=e*t;if(y>65536)throw"Sonogram 3D resolution is too high: can only handle 65536 vertices max";g=new Float32Array(3*y),f=new Float32Array(2*y);for(var b=0;b<t;b++)for(var E=0;E<e;E++)g[3*(e*b+E)+0]=c*(E-e/2)/e,g[3*(e*b+E)+1]=0,g[3*(e*b+E)+2]=c*(b-t/2)/t,f[2*(e*b+E)+0]=E/(e-1),f[2*(e*b+E)+1]=b/(t-1);var w=g.byteLength;this.vbo3DTexCoordOffset=w;var T=d.createBuffer();this.sonogram3DVBO=T,d.bindBuffer(d.ARRAY_BUFFER,T),d.bufferData(d.ARRAY_BUFFER,w+f.byteLength,d.STATIC_DRAW),d.bufferSubData(d.ARRAY_BUFFER,0,g),d.bufferSubData(d.ARRAY_BUFFER,w,f);var x=(e-1)*(t-1)*6;this.sonogram3DNumIndices=x-3600;var j=new Uint16Array(x),S=0;for(b=0;b<t-1;b++)for(E=0;E<e-1;E++)j[S++]=b*e+E,j[S++]=b*e+E+1,j[S++]=(b+1)*e+E+1,j[S++]=b*e+E,j[S++]=(b+1)*e+E+1,j[S++]=(b+1)*e+E;var _=d.createBuffer();this.sonogram3DIBO=_,d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,_),d.bufferData(d.ELEMENT_ARRAY_BUFFER,j,d.STATIC_DRAW),this.frequencyShader=i.shader.loadFromURL(d,n(42),n(92)),this.waveformShader=i.shader.loadFromURL(d,n(42),n(93)),this.sonogramShader=i.shader.loadFromURL(d,n(42),n(52)),this.has3DVisualizer&&(this.sonogram3DShader=i.shader.loadFromURL(d,n(94),n(52))),console.log("this.sonogramShader",this.sonogramShader),console.log("this.sonogram3DShader",this.sonogram3DShader)},c.prototype.initByteBuffer=function(){var e=this.gl,t=this.TEXTURE_HEIGHT;if(!this.freqByteData||this.freqByteData.length!=this.analyser.frequencyBinCount){var n=new Uint8Array(this.analyser.frequencyBinCount);this.freqByteData=n,this.texture&&(e.deleteTexture(this.texture),this.texture=null);var s=e.createTexture();this.texture=s,e.bindTexture(e.TEXTURE_2D,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR);var r=new Uint8Array(n.length*t);e.texImage2D(e.TEXTURE_2D,0,e.ALPHA,n.length,t,0,e.ALPHA,e.UNSIGNED_BYTE,r)}},c.prototype.setAnalysisType=function(e){(this.has3DVisualizer||2!=e)&&(this.analysisType=e)},c.prototype.analysisType=function(){return this.analysisType},c.prototype.doFrequencyAnalysis=function(e){var t=this.freqByteData;switch(this.analysisType){case 0:this.analyser.smoothingTimeConstant=.75,this.analyser.getByteFrequencyData(t);break;case 1:case 2:this.analyser.smoothingTimeConstant=0,this.analyser.getByteFrequencyData(t);break;case 3:this.analyser.smoothingTimeConstant=.1,this.analyser.getByteTimeDomainData(t)}this.drawGL()},c.prototype.drawGL=function(){var e=this.canvas,t=this.gl,n=this.vbo,r=this.vboTexCoordOffset,i=this.sonogram3DVBO,c=this.vbo3DTexCoordOffset,h=this.sonogram3DGeometrySize,u=this.sonogram3DNumIndices,d=(this.sonogram3DWidth,this.sonogram3DHeight),m=this.freqByteData,g=this.texture,f=this.TEXTURE_HEIGHT,p=this.frequencyShader,v=this.waveformShader,y=this.sonogramShader,b=this.sonogram3DShader;t.bindTexture(t.TEXTURE_2D,g),t.pixelStorei(t.UNPACK_ALIGNMENT,1),1!=this.analysisType&&2!=this.analysisType&&(this.yoffset=0),t.texSubImage2D(t.TEXTURE_2D,0,0,this.yoffset,m.length,1,t.ALPHA,t.UNSIGNED_BYTE,m),1!=this.analysisType&&2!=this.analysisType||(this.yoffset=(this.yoffset+1)%f);var E,w,T,x,j,S,_,A=this.yoffset;switch(this.analysisType){case 0:case 3:t.bindBuffer(t.ARRAY_BUFFER,n),(_=0==this.analysisType?p:v).bind(),E=_.gPositionLoc,w=_.gTexCoord0Loc,T=_.frequencyDataLoc,x=_.foregroundColorLoc,j=_.backgroundColorLoc,t.uniform1f(_.yoffsetLoc,.5/(f-1)),S=r;break;case 1:t.bindBuffer(t.ARRAY_BUFFER,n),y.bind(),E=y.gPositionLoc,w=y.gTexCoord0Loc,T=y.frequencyDataLoc,x=y.foregroundColorLoc,j=y.backgroundColorLoc,t.uniform1f(y.yoffsetLoc,A/(f-1)),S=r;break;case 2:t.bindBuffer(t.ARRAY_BUFFER,i),b.bind(),E=b.gPositionLoc,w=b.gTexCoord0Loc,T=b.frequencyDataLoc,x=b.foregroundColorLoc,j=b.backgroundColorLoc,t.uniform1i(b.vertexFrequencyDataLoc,0);var R=this.yoffset/(f-1);t.uniform1f(b.yoffsetLoc,R);var O=Math.floor(R*(d-1))/(d-1);t.uniform1f(b.vertexYOffsetLoc,O),t.uniform1f(b.verticalScaleLoc,h/3.5),l.loadIdentity(),l.perspective(55,e.width/e.height,1,100),o.loadIdentity(),o.translate(0,0,-9),a.loadIdentity(),a.rotate(this.cameraController.xRot,1,0,0),a.rotate(this.cameraController.yRot,0,1,0),a.rotate(this.cameraController.zRot,0,0,1),a.translate(this.cameraController.xT,this.cameraController.yT,this.cameraController.zT);var C=new s;C.multiply(a),C.multiply(o),C.multiply(l),t.uniformMatrix4fv(b.worldViewProjectionLoc,t.FALSE,C.elements),S=c}T&&t.uniform1i(T,0),x&&t.uniform4fv(x,this.foregroundColor),j&&t.uniform4fv(j,this.backgroundColor),t.enableVertexAttribArray(E),t.vertexAttribPointer(E,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(w),t.vertexAttribPointer(w,2,t.FLOAT,t.FALSE,0,S),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),0==this.analysisType||3==this.analysisType||1==this.analysisType?t.drawArrays(t.TRIANGLES,0,6):2==this.analysisType&&t.drawElements(t.TRIANGLES,u,t.UNSIGNED_SHORT,0),t.disableVertexAttribArray(E),t.disableVertexAttribArray(w)},c.prototype.setAnalyserNode=function(e){this.analyser=e},e.exports=c},89:function(e,t){function n(){this.elements=Array(16),this.loadIdentity()}n.prototype={scale:function(e,t,n){return this.elements[0]*=e,this.elements[1]*=e,this.elements[2]*=e,this.elements[3]*=e,this.elements[4]*=t,this.elements[5]*=t,this.elements[6]*=t,this.elements[7]*=t,this.elements[8]*=n,this.elements[9]*=n,this.elements[10]*=n,this.elements[11]*=n,this},translate:function(e,t,n){return this.elements[12]+=this.elements[0]*e+this.elements[4]*t+this.elements[8]*n,this.elements[13]+=this.elements[1]*e+this.elements[5]*t+this.elements[9]*n,this.elements[14]+=this.elements[2]*e+this.elements[6]*t+this.elements[10]*n,this.elements[15]+=this.elements[3]*e+this.elements[7]*t+this.elements[11]*n,this},rotate:function(e,t,s,r){var i,a,o,l,c,h,u,d,m,g,f,p=Math.sqrt(t*t+s*s+r*r),v=Math.sin(e*Math.PI/180),y=Math.cos(e*Math.PI/180);p>0&&(i=(t/=p)*t,a=(s/=p)*s,o=(r/=p)*r,l=t*s,c=s*r,h=r*t,u=t*v,d=s*v,m=r*v,g=1-y,(f=new n).elements[0]=g*i+y,f.elements[1]=g*l-m,f.elements[2]=g*h+d,f.elements[3]=0,f.elements[4]=g*l+m,f.elements[5]=g*a+y,f.elements[6]=g*c-u,f.elements[7]=0,f.elements[8]=g*h-d,f.elements[9]=g*c+u,f.elements[10]=g*o+y,f.elements[11]=0,f.elements[12]=0,f.elements[13]=0,f.elements[14]=0,f.elements[15]=1,f=f.multiply(this),this.elements=f.elements);return this},frustum:function(e,t,s,r,i,a){var o,l=t-e,c=r-s,h=a-i;return i<=0||a<=0||l<=0||c<=0||h<=0?this:((o=new n).elements[0]=2*i/l,o.elements[1]=o.elements[2]=o.elements[3]=0,o.elements[5]=2*i/c,o.elements[4]=o.elements[6]=o.elements[7]=0,o.elements[8]=(t+e)/l,o.elements[9]=(r+s)/c,o.elements[10]=-(i+a)/h,o.elements[11]=-1,o.elements[14]=-2*i*a/h,o.elements[12]=o.elements[13]=o.elements[15]=0,o=o.multiply(this),this.elements=o.elements,this)},perspective:function(e,t,n,s){var r=Math.tan(e/360*Math.PI)*n,i=r*t;return this.frustum(-i,i,-r,r,n,s)},ortho:function(e,t,s,r,i,a){var o=t-e,l=r-s,c=a-i,h=new n;return 0==o||0==l||0==c?this:(h.elements[0]=2/o,h.elements[12]=-(t+e)/o,h.elements[5]=2/l,h.elements[13]=-(r+s)/l,h.elements[10]=-2/c,h.elements[14]=-(i+a)/c,h=h.multiply(this),this.elements=h.elements,this)},multiply:function(e){for(var t=new n,s=0;s<4;s++)t.elements[4*s+0]=this.elements[4*s+0]*e.elements[0]+this.elements[4*s+1]*e.elements[4]+this.elements[4*s+2]*e.elements[8]+this.elements[4*s+3]*e.elements[12],t.elements[4*s+1]=this.elements[4*s+0]*e.elements[1]+this.elements[4*s+1]*e.elements[5]+this.elements[4*s+2]*e.elements[9]+this.elements[4*s+3]*e.elements[13],t.elements[4*s+2]=this.elements[4*s+0]*e.elements[2]+this.elements[4*s+1]*e.elements[6]+this.elements[4*s+2]*e.elements[10]+this.elements[4*s+3]*e.elements[14],t.elements[4*s+3]=this.elements[4*s+0]*e.elements[3]+this.elements[4*s+1]*e.elements[7]+this.elements[4*s+2]*e.elements[11]+this.elements[4*s+3]*e.elements[15];return this.elements=t.elements,this},copy:function(){for(var e=new n,t=0;t<16;t++)e.elements[t]=this.elements[t];return e},get:function(e,t){return this.elements[4*e+t]},invert:function(){var e=this.get(2,2)*this.get(3,3),t=this.get(3,2)*this.get(2,3),n=this.get(1,2)*this.get(3,3),s=this.get(3,2)*this.get(1,3),r=this.get(1,2)*this.get(2,3),i=this.get(2,2)*this.get(1,3),a=this.get(0,2)*this.get(3,3),o=this.get(3,2)*this.get(0,3),l=this.get(0,2)*this.get(2,3),c=this.get(2,2)*this.get(0,3),h=this.get(0,2)*this.get(1,3),u=this.get(1,2)*this.get(0,3),d=this.get(2,0)*this.get(3,1),m=this.get(3,0)*this.get(2,1),g=this.get(1,0)*this.get(3,1),f=this.get(3,0)*this.get(1,1),p=this.get(1,0)*this.get(2,1),v=this.get(2,0)*this.get(1,1),y=this.get(0,0)*this.get(3,1),b=this.get(3,0)*this.get(0,1),E=this.get(0,0)*this.get(2,1),w=this.get(2,0)*this.get(0,1),T=this.get(0,0)*this.get(1,1),x=this.get(1,0)*this.get(0,1),j=e*this.get(1,1)+s*this.get(2,1)+r*this.get(3,1)-(t*this.get(1,1)+n*this.get(2,1)+i*this.get(3,1)),S=t*this.get(0,1)+a*this.get(2,1)+c*this.get(3,1)-(e*this.get(0,1)+o*this.get(2,1)+l*this.get(3,1)),_=n*this.get(0,1)+o*this.get(1,1)+h*this.get(3,1)-(s*this.get(0,1)+a*this.get(1,1)+u*this.get(3,1)),A=i*this.get(0,1)+l*this.get(1,1)+u*this.get(2,1)-(r*this.get(0,1)+c*this.get(1,1)+h*this.get(2,1)),R=1/(this.get(0,0)*j+this.get(1,0)*S+this.get(2,0)*_+this.get(3,0)*A),O=R*j,C=R*S,I=R*_,F=R*A,L=R*(t*this.get(1,0)+n*this.get(2,0)+i*this.get(3,0)-(e*this.get(1,0)+s*this.get(2,0)+r*this.get(3,0))),B=R*(e*this.get(0,0)+o*this.get(2,0)+l*this.get(3,0)-(t*this.get(0,0)+a*this.get(2,0)+c*this.get(3,0))),D=R*(s*this.get(0,0)+a*this.get(1,0)+u*this.get(3,0)-(n*this.get(0,0)+o*this.get(1,0)+h*this.get(3,0))),k=R*(r*this.get(0,0)+c*this.get(1,0)+h*this.get(2,0)-(i*this.get(0,0)+l*this.get(1,0)+u*this.get(2,0))),P=R*(d*this.get(1,3)+f*this.get(2,3)+p*this.get(3,3)-(m*this.get(1,3)+g*this.get(2,3)+v*this.get(3,3))),q=R*(m*this.get(0,3)+y*this.get(2,3)+w*this.get(3,3)-(d*this.get(0,3)+b*this.get(2,3)+E*this.get(3,3))),N=R*(g*this.get(0,3)+b*this.get(1,3)+T*this.get(3,3)-(f*this.get(0,3)+y*this.get(1,3)+x*this.get(3,3))),M=R*(v*this.get(0,3)+E*this.get(1,3)+x*this.get(2,3)-(p*this.get(0,3)+w*this.get(1,3)+T*this.get(2,3))),U=R*(g*this.get(2,2)+v*this.get(3,2)+m*this.get(1,2)-(p*this.get(3,2)+d*this.get(1,2)+f*this.get(2,2))),z=R*(E*this.get(3,2)+d*this.get(0,2)+b*this.get(2,2)-(y*this.get(2,2)+w*this.get(3,2)+m*this.get(0,2))),H=R*(y*this.get(1,2)+x*this.get(3,2)+f*this.get(0,2)-(T*this.get(3,2)+g*this.get(0,2)+b*this.get(1,2))),X=R*(T*this.get(2,2)+p*this.get(0,2)+w*this.get(1,2)-(E*this.get(1,2)+x*this.get(2,2)+v*this.get(0,2)));return this.elements[0]=O,this.elements[1]=C,this.elements[2]=I,this.elements[3]=F,this.elements[4]=L,this.elements[5]=B,this.elements[6]=D,this.elements[7]=k,this.elements[8]=P,this.elements[9]=q,this.elements[10]=N,this.elements[11]=M,this.elements[12]=U,this.elements[13]=z,this.elements[14]=H,this.elements[15]=X,this},inverse:function(){return this.copy().invert()},transpose:function(){var e=this.elements[1];return this.elements[1]=this.elements[4],this.elements[4]=e,e=this.elements[2],this.elements[2]=this.elements[8],this.elements[8]=e,e=this.elements[3],this.elements[3]=this.elements[12],this.elements[12]=e,e=this.elements[6],this.elements[6]=this.elements[9],this.elements[9]=e,e=this.elements[7],this.elements[7]=this.elements[13],this.elements[13]=e,e=this.elements[11],this.elements[11]=this.elements[14],this.elements[14]=e,this},loadIdentity:function(){for(var e=0;e<16;e++)this.elements[e]=0;return this.elements[0]=1,this.elements[5]=1,this.elements[10]=1,this.elements[15]=1,this}},e.exports=n},90:function(e,t){e.exports=function(e,t,n){this.onchange=null,this.xRot=0,this.yRot=0,this.zRot=0,this.scaleFactor=3,this.dragging=!1,this.curX=0,this.curY=0,t&&(this.canvas_=t),n&&(this.context_=n)}},91:function(e,t,n){var s=n(51);s.provide("o3djs.shader"),s.shader=s.shader||{},s.shader.loadFromScriptNodes=function(e,t,n){var r=document.getElementById(t),i=document.getElementById(n);return r&&i?new s.shader.Shader(e,r.text,i.text):null},s.shader.loadTextFileSynchronous=function(e){var t,n='loadTextFileSynchronous failed to load url "'+e+'"';if((t=new XMLHttpRequest).overrideMimeType&&t.overrideMimeType("text/plain"),t.open("GET",e,!1),t.send(null),4!=t.readyState)throw n;return t.responseText},s.shader.loadFromURL=function(e,t,n){var r=s.shader.loadTextFileSynchronous(t),i=s.shader.loadTextFileSynchronous(n);return r&&i?new s.shader.Shader(e,r,i):null},s.shader.glslNameToJs_=function(e){return e.replace(/_(.)/g,(function(e,t){return t.toUpperCase()}))},s.shader.Shader=function(e,t,n){this.program=e.createProgram(),this.gl=e;var r=this.loadShader(this.gl.VERTEX_SHADER,t);if(null!=r){this.gl.attachShader(this.program,r),this.gl.deleteShader(r);var i=this.loadShader(this.gl.FRAGMENT_SHADER,n);if(null!=i){if(this.gl.attachShader(this.program,i),this.gl.deleteShader(i),this.gl.linkProgram(this.program),this.gl.useProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS)){var a=this.gl.getProgramInfoLog(this.program);return console.error("Error linking program:\n"+a),this.gl.deleteProgram(this.program),void(this.program=null)}for(var o=/(uniform|attribute)\s+\S+\s+(\S+)\s*;/g,l=null;null!=(l=o.exec(t+"\n"+n));){var c=l[2],h=s.shader.glslNameToJs_(c);"uniform"==l[1]?this[h+"Loc"]=this.getUniform(c):"attribute"==l[1]&&(this[h+"Loc"]=this.getAttribute(c))}}}},s.shader.Shader.prototype.bind=function(){this.gl.useProgram(this.program)},s.shader.Shader.prototype.loadShader=function(e,t){var n=this.gl.createShader(e);if(null==n)return null;if(this.gl.shaderSource(n,t),this.gl.compileShader(n),!this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS)){var s=this.gl.getShaderInfoLog(n);return console.error("Error compiling shader:\n"+s),this.gl.deleteShader(n),null}return n},s.shader.Shader.prototype.getAttribute=function(e){return this.gl.getAttribLocation(this.program,e)},s.shader.Shader.prototype.getUniform=function(e){return this.gl.getUniformLocation(this.program,e)}},92:function(e,t,n){e.exports=n.p+"static/media/frequency-fragment.a9bc450e.shader"},93:function(e,t,n){e.exports=n.p+"static/media/waveform-fragment.cab01b30.shader"},94:function(e,t,n){e.exports=n.p+"static/media/sonogram-vertex.66fd52b4.shader"},95:function(e,t,n){"use strict";n.r(t);var s=n(31),r=n(19),i=n(53),a=n(54),o=n(65),l=n(0),c=n.n(l),h=n(10),u=n.n(h),d=n(145),m=n(11),g=n(138),f=n(4),p=n(32);function v(e){return c.a.createElement(p.a,e,c.a.createElement("svg",{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 32 32",enableBackground:"new 0 0 32 32"},c.a.createElement("polyline",{fill:"none",strokeMiterlimit:"10",strokeWidth:"2.5",stroke:"currentColor",points:"1.5,15.5 1.5,1.5 16.5,1.5 16.5,30.5 30.5,30.5 30.5,15.5 "})))}function y(e){return c.a.createElement(p.a,e,c.a.createElement("svg",{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 32 32",enableBackground:"new 0 0 32 32"},c.a.createElement("polyline",{fill:"none",strokeMiterlimit:"10",strokeWidth:"2.5",stroke:"currentColor",points:"1.5,15.5 9.5,1.5 22.5,30.5 30.5,15.5"})))}function b(e){return c.a.createElement(p.a,e,c.a.createElement("svg",{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 32 32",enableBackground:"new 0 0 32 32"},c.a.createElement("polyline",{fill:"none",strokeMiterlimit:"10",strokeWidth:"2.5",stroke:"currentColor",points:"1.5,15.5 1.5,1.5 30.5,30.5 30.5,15.5 "})))}function E(e){return c.a.createElement(p.a,e,c.a.createElement("svg",{version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 32 32",enableBackground:"new 0 0 32 32"},c.a.createElement("path",{fill:"none",strokeMiterlimit:"10",strokeWidth:"2.5",stroke:"currentColor",d:"M30.5,15.5c0,17-14,17.8-14,0c0-17.2-15-16-15,0 "})))}var w=n(56),T=n.n(w),x=n(141),j=n(139),S=n(140),_=n(151),A=Object(g.a)((function(e){return{paper:{display:"flex",border:"1px solid ".concat(e.palette.divider),flexWrap:"wrap"},divider:{alignSelf:"stretch",height:"auto",margin:e.spacing(1,.5)}}})),R=Object(f.a)((function(e){return{grouped:{margin:e.spacing(.5),border:"none",padding:e.spacing(0,1),"&:not(:first-child)":{borderRadius:e.shape.borderRadius},"&:first-child":{borderRadius:e.shape.borderRadius}}}}))(_.a);function O(e){var t=e.optionsChangeCallback,n=c.a.useState("sine"),s=Object(m.a)(n,2),r=s[0],i=s[1],a=c.a.useState(!0),o=Object(m.a)(a,2),l=o[0],h=o[1],u=A();return c.a.createElement("div",null,c.a.createElement(j.a,{elevation:0,className:u.paper},c.a.createElement(R,{size:"small",value:r,exclusive:!0,onChange:function(e,n){null!==n&&(i(n),t({waveform:n,loop:l}))},"aria-label":"waveform"},c.a.createElement(S.a,{value:"square","aria-label":"square waves"},c.a.createElement(v,null)),c.a.createElement(S.a,{value:"triangle","aria-label":"triangle waves"},c.a.createElement(y,null)),c.a.createElement(S.a,{value:"sawtooth","aria-label":"sawtooth waves"},c.a.createElement(b,null)),c.a.createElement(S.a,{value:"sine","aria-label":"sine waves"},c.a.createElement(E,null))),c.a.createElement(x.a,{orientation:"vertical",className:u.divider}),c.a.createElement(R,{size:"small","arial-label":"text formatting"},c.a.createElement(S.a,{value:"loop",selected:l,onClick:function(){h(!l),t({waveform:r,loop:!l})},"aria-label":"loop audio"},c.a.createElement(T.a,null)))))}var C=n(43),I=n.n(C),F=n(57),L=n(2),B=n(13),D=n(149),k=n(150),P=n(144),q=n(146),N=n(37),M=n.n(N),U=n(38),z=n.n(U),H=n(142),X=n(25),G=n(66);function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){Object(B.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function V(e){var t=e.data,n=e.index,s=e.style;return c.a.cloneElement(t[n],{style:W({overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",display:"block"},s)})}var J=c.a.forwardRef((function(e,t){var n=e.children,s=Object(L.a)(e,["children"]),r=Object(X.a)(),i=Object(H.a)(r.breakpoints.up("sm")),a=Array.isArray(n)?n.length:0,o=2.2*(i?36:48),l=c.a.useMemo((function(){return c.a.forwardRef((function(e,t){return c.a.createElement("div",Object.assign({ref:t},e,s))}))}),[]);return c.a.createElement("div",{ref:t},c.a.createElement(G.a,{style:{padding:0,height:Math.min(3,a)*o,maxHeight:"auto"},itemData:n,height:250,width:"100%",outerElementType:l,innerElementType:"ul",itemSize:o,overscanCount:5,itemCount:a},V))})),$=Object(g.a)({listbox:{"& ul":{padding:0,margin:0}}});function Q(e){var t=e.presetsChangeCallback,n=$(),s=c.a.useState(!1),r=Object(m.a)(s,2),i=r[0],a=r[1],o=c.a.useState([]),l=Object(m.a)(o,2),h=l[0],u=l[1],g=c.a.useState(JSON.parse(localStorage.getItem("selectedPresets")||"[]")),f=Object(m.a)(g,2),p=f[0],v=f[1],y=i&&0===h.length;return c.a.useEffect((function(){localStorage.setItem("selectedPresets",JSON.stringify(p))}),[p]),c.a.useEffect((function(){var e=!0;if(y)return Object(F.a)(I.a.mark((function t(){var n,s,r,i;return I.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=localStorage.getItem("presets")){t.next=10;break}return t.next=4,fetch("".concat("/cafl-player-react/build","/cafl.json"));case 4:return s=t.sent,t.next=7,s.json();case 7:r=t.sent,localStorage.setItem("presets",JSON.stringify(r)),n=localStorage.getItem("presets");case 10:i=JSON.parse(n),e&&u(Object.keys(i.programs).map((function(e){var t=i.programs[e],n=e;return t.comments||(t.comments="None"),t.frequencies||(t.frequencies=[]),W({name:n},i.programs[e])})));case 12:case"end":return t.stop()}}),t)})))(),function(){e=!1}}),[y]),c.a.createElement(k.a,{id:"presets",multiple:!0,open:i,onOpen:function(){a(!0)},onClose:function(){a(!1)},value:p,onChange:function(e,n){v(n),t(n)},getOptionLabel:function(e){return e.name},filterSelectedOptions:!0,filterOptions:function(e,t){if(e.length>0){var n=t.inputValue.toLowerCase();return e.filter((function(e){return!!(e.name.toLowerCase().includes(n)||e.comments&&e.comments.toLowerCase().includes(n))}))}return[]},disableListWrap:!0,classes:n,ListboxComponent:J,freeSolo:!0,autoHighlight:!0,options:h,loading:y,renderInput:function(e){return c.a.createElement(D.a,Object.assign({},e,{label:"Presets",fullWidth:!0,variant:"outlined",InputProps:W({},e.InputProps,{endAdornment:c.a.createElement(c.a.Fragment,null,y?c.a.createElement(P.a,{color:"inherit",size:20}):null,e.InputProps.endAdornment)})}))},renderOption:function(e,t){var n=t.inputValue,s={insideWords:!0,findAllOccurrences:!0},r=z()(e.name,n,s),i=M()(e.name,r),a=z()(e.comments,n,s),o=M()(e.comments,a),l=e.frequencies?e.frequencies.join(", "):void 0,h=z()(l,n,s),u=M()(l,h);return c.a.createElement(d.a,{container:!0,alignItems:"center"},c.a.createElement(d.a,{item:!0,xs:!0},i.map((function(e,t){return c.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})),c.a.createElement(q.a,{variant:"body2",color:"textSecondary"},e.comments&&"Comments: ",e.comments&&o.map((function(e,t){return c.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)}))),c.a.createElement(q.a,{variant:"body2",color:"textSecondary"},e.frequencies&&"Frequencies: ",e.frequencies&&u.map((function(e,t){return c.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})))))}})}var K=n(147),Z=n(60),ee=n.n(Z),te=n(61),ne=n.n(te),se=Object(g.a)((function(e){return{fab:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)}}}));function re(e){var t,n,s=e.presets,r=e.options,i=se(),a=c.a.useState(!1),o=Object(m.a)(a,2),l=o[0],h=o[1],u=c.a.useRef(null),d=c.a.useRef(null),g=1e3,f=[];function p(){if(u.current)try{u.current.onended=function(){},u.current.stop(0)}catch(e){}u.current=void 0,t=void 0}function v(e,t){f.push(setTimeout((function(){e}),t*g))}function y(){b(),p(),d.current=d.current||new(window.AudioContext||window.webkitAudioContext),t=d.current.createAnalyser(),u.current=d.current.createOscillator(),u.current.connect(t),t.connect(d.current.destination),t.fftSize=1024,u.current.type=r.waveform;for(var e=d.current.currentTime,i=0,a=[],o=0;o<s.length;o++){var l=s[o];l.frequencies&&(a=a.concat(l.frequencies))}var c=!0,h=!1,m=void 0;try{for(var g,f=a[Symbol.iterator]();!(c=(g=f.next()).done);c=!0){var E=g.value;u.current.frequency.setValueAtTime(E,e),v(E,i),e+=180,i+=180}}catch(w){h=!0,m=w}finally{try{c||null==f.return||f.return()}finally{if(h)throw m}}n=t.frequencyBinCount,new Uint8Array(n),u.current.onended=function(){console.log("onEnded event signled"),r.loop?setTimeout((function(){console.log("Repeating"),y()}),0):b()},1e3*i,u.current.start(),u.current.stop(e)}function b(){for(p();f.length;)clearTimeout(f.pop());v(0,0),void 0}function E(){var e=!l&&s.length>0;e?((new Date).getTime(),b(),d.current&&(d.current.close(),d.current=void 0),y()):(b(),d.current&&(d.current.close(),d.current=void 0)),h(e)}return c.a.createElement("div",null,l?c.a.createElement(K.a,{"aria-label":"Stop",className:i.fab,color:"secondary",onClick:E},c.a.createElement(ne.a,null)):c.a.createElement(K.a,{"aria-label":"Play",className:i.fab,color:"primary",onClick:E},c.a.createElement(ee.a,null)))}var ie=n(148),ae=n(64),oe=n(62),le=n.n(oe),ce=n(63),he=n.n(ce);n(85);var ue=Object(ae.a)({palette:{primary:le.a,secondary:he.a}}),de=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(i.a)(this,Object(a.a)(t).call(this,e))).state={presets:JSON.parse(localStorage.getItem("selectedPresets")||"[]"),options:{waveform:"sine",loop:!0}},n}return Object(o.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:ue.root},c.a.createElement("canvas",{id:"spectrogram"}),c.a.createElement(d.a,{container:!0,spacing:3},c.a.createElement(d.a,{item:!0,xs:12},c.a.createElement(Q,{presetsChangeCallback:function(t){e.setState({presets:t||[]})}})),c.a.createElement(d.a,{item:!0,xs:12,sm:6},c.a.createElement(O,{optionsChangeCallback:function(t){e.setState({options:t})}})),c.a.createElement(d.a,{item:!0,xs:12},c.a.createElement(re,{presets:this.state.presets,options:this.state.options}))))}}]),t}(c.a.Component);u.a.render(c.a.createElement(ie.a,{theme:ue},c.a.createElement(de,null)),document.getElementById("root"))}},[[73,1,2]]]);
//# sourceMappingURL=main.a77f0dcc.chunk.js.map